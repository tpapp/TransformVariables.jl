<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · TransformVariables.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">TransformVariables.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Internals</a><ul class="internal"><li><a class="tocitem" href="#Types-for-various-transformations-1"><span>Types for various transformations</span></a></li><li><a class="tocitem" href="#Types-and-type-aliases-1"><span>Types and type aliases</span></a></li><li><a class="tocitem" href="#Conditional-calculation-of-log-Jacobian-determinant-1"><span>Conditional calculation of log Jacobian determinant</span></a></li><li><a class="tocitem" href="#Macros-1"><span>Macros</span></a></li><li><a class="tocitem" href="#Helper-functions-1"><span>Helper functions</span></a></li><li><a class="tocitem" href="#Building-blocks-for-transformations-1"><span>Building blocks for transformations</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tpapp/TransformVariables.jl/blob/master/docs/src/internals.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Internals-1"><a class="docs-heading-anchor" href="#Internals-1">Internals</a><a class="docs-heading-anchor-permalink" href="#Internals-1" title="Permalink"></a></h1><h2 id="Types-for-various-transformations-1"><a class="docs-heading-anchor" href="#Types-for-various-transformations-1">Types for various transformations</a><a class="docs-heading-anchor-permalink" href="#Types-for-various-transformations-1" title="Permalink"></a></h2><p>These are not part of the API, use the <code>as</code> constructor or one of the predefined constants.</p><h3 id="Scalar-transformations-1"><a class="docs-heading-anchor" href="#Scalar-transformations-1">Scalar transformations</a><a class="docs-heading-anchor-permalink" href="#Scalar-transformations-1" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.Identity" href="#TransformVariables.Identity"><code>TransformVariables.Identity</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct Identity &lt;: TransformVariables.ScalarTransform</code></pre><p>Identity <span>$x ↦ x$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.ScaledShiftedLogistic" href="#TransformVariables.ScaledShiftedLogistic"><code>TransformVariables.ScaledShiftedLogistic</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct ScaledShiftedLogistic{T&lt;:Real} &lt;: TransformVariables.ScalarTransform</code></pre><p>Maps to <code>(scale, shift + scale)</code> using <code>x ↦ logistic(x)*scale + shift</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.ShiftedExp" href="#TransformVariables.ShiftedExp"><code>TransformVariables.ShiftedExp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct ShiftedExp{D, T&lt;:Real} &lt;: TransformVariables.ScalarTransform</code></pre><p>Shifted exponential. When <code>D::Bool == true</code>, maps to <code>(shift, ∞)</code> using <code>x ↦ shift + eˣ</code>, otherwise to <code>(-∞, shift)</code> using <code>x ↦ shift - eˣ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section></article><h3 id="Aggregating-transformations-1"><a class="docs-heading-anchor" href="#Aggregating-transformations-1">Aggregating transformations</a><a class="docs-heading-anchor-permalink" href="#Aggregating-transformations-1" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.ArrayTransform" href="#TransformVariables.ArrayTransform"><code>TransformVariables.ArrayTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct ArrayTransform{T&lt;:TransformVariables.AbstractTransform, M} &lt;: TransformVariables.VectorTransform</code></pre><p>Apply <code>transformation</code> repeatedly to create an array with given <code>dims</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.TransformTuple" href="#TransformVariables.TransformTuple"><code>TransformVariables.TransformTuple</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct TransformTuple{T} &lt;: TransformVariables.VectorTransform</code></pre><p>Transform consecutive groups of real numbers to a tuple, using the given transformations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section></article><h3 id="Wrapper-for-inverse-1"><a class="docs-heading-anchor" href="#Wrapper-for-inverse-1">Wrapper for inverse</a><a class="docs-heading-anchor-permalink" href="#Wrapper-for-inverse-1" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.InverseTransform" href="#TransformVariables.InverseTransform"><code>TransformVariables.InverseTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct InverseTransform{T}</code></pre><p>Inverse of the wrapped transform. Use the 1-argument version of <a href="../#TransformVariables.inverse"><code>inverse</code></a> to construct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/generic.jl#L113">source</a></section></article><h2 id="Types-and-type-aliases-1"><a class="docs-heading-anchor" href="#Types-and-type-aliases-1">Types and type aliases</a><a class="docs-heading-anchor-permalink" href="#Types-and-type-aliases-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.AbstractTransform" href="#TransformVariables.AbstractTransform"><code>TransformVariables.AbstractTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">abstract type AbstractTransform</code></pre><p>Supertype for all transformations in this package.</p><p><strong>Interface</strong></p><p>The user interface consists of</p><ul><li><a href="../#TransformVariables.dimension"><code>dimension</code></a></li><li><a href="../#TransformVariables.transform"><code>transform</code></a></li><li><a href="../#TransformVariables.transform_and_logjac"><code>transform_and_logjac</code></a></li><li>[<code>inverse</code>]@(ref), <a href="../#TransformVariables.inverse!"><code>inverse!</code></a></li><li><a href="../#TransformVariables.inverse_eltype"><code>inverse_eltype</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/generic.jl#L94">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.ScalarTransform" href="#TransformVariables.ScalarTransform"><code>TransformVariables.ScalarTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">abstract type ScalarTransform &lt;: TransformVariables.AbstractTransform</code></pre><p>Transform a scalar (real number) to another scalar.</p><p>Subtypes mustdefine <code>transform</code>, <code>transform_and_logjac</code>, and <code>inverse</code>; other methods of of the interface should have the right defaults.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/scalar.jl#L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.VectorTransform" href="#TransformVariables.VectorTransform"><code>TransformVariables.VectorTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">abstract type VectorTransform &lt;: TransformVariables.AbstractTransform</code></pre><p>Transformation that transforms <code>&lt;: AbstractVector</code>s to other values.</p><p><strong>Implementation</strong></p><p>Implements <a href="../#TransformVariables.transform"><code>transform</code></a> and <a href="../#TransformVariables.transform_and_logjac"><code>transform_and_logjac</code></a> via <a href="#TransformVariables.transform_with"><code>transform_with</code></a>, and <a href="../#TransformVariables.inverse"><code>inverse</code></a> via <a href="../#TransformVariables.inverse!"><code>inverse!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/generic.jl#L202">source</a></section></article><h2 id="Conditional-calculation-of-log-Jacobian-determinant-1"><a class="docs-heading-anchor" href="#Conditional-calculation-of-log-Jacobian-determinant-1">Conditional calculation of log Jacobian determinant</a><a class="docs-heading-anchor-permalink" href="#Conditional-calculation-of-log-Jacobian-determinant-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.LogJacFlag" href="#TransformVariables.LogJacFlag"><code>TransformVariables.LogJacFlag</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">abstract type LogJacFlag</code></pre><p>Flag used internally by the implementation of transformations, as explained below.</p><p>When calculating the log jacobian determinant for a matrix, initialize with</p><pre><code class="language-julia">logjac_zero(flag, x)</code></pre><p>and then accumulate with log jacobians as needed with <code>+</code>.</p><p>When <code>flag</code> is <code>LogJac</code>, methods should return the log Jacobian as the second argument, otherwise <code>NoLogJac</code>, which simply combines to itself with <code>+</code>, serving as an empty placeholder. This allows methods to share code of the two implementations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/generic.jl#L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.LogJac" href="#TransformVariables.LogJac"><code>TransformVariables.LogJac</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Calculate log Jacobian as the second value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/generic.jl#L26-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.NoLogJac" href="#TransformVariables.NoLogJac"><code>TransformVariables.NoLogJac</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Don&#39;t calculate log Jacobian, return <code>NOLOGJAC</code> as the second value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/generic.jl#L33-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.logjac_zero" href="#TransformVariables.logjac_zero"><code>TransformVariables.logjac_zero</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">logjac_zero(?, T)
</code></pre><p>Initial value for log Jacobian calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/generic.jl#L42">source</a></section></article><h2 id="Macros-1"><a class="docs-heading-anchor" href="#Macros-1">Macros</a><a class="docs-heading-anchor-permalink" href="#Macros-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.@calltrans" href="#TransformVariables.@calltrans"><code>TransformVariables.@calltrans</code></a> — <span class="docstring-category">Macro</span></header><section><div><p>Workaround for https://github.com/JuliaLang/julia/issues/14919 to make transformation types callable.</p><p>TODO: remove when this issue is closed, also possibly remove MacroTools as a dependency if not used elsewhere.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/utilities.jl#L49">source</a></section></article><h2 id="Helper-functions-1"><a class="docs-heading-anchor" href="#Helper-functions-1">Helper functions</a><a class="docs-heading-anchor-permalink" href="#Helper-functions-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.transform_with" href="#TransformVariables.transform_with"><code>TransformVariables.transform_with</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">transform_with(flag::LogJacFlag, transformation, x::AbstractVector, index)</code></pre><p>Transform elements of <code>x</code> from <code>index</code>, using <code>transformation</code>.</p><p>Return <code>(y, logjac), index′</code>, where</p><ul><li><p><code>y</code> is the result of the transformation,</p></li><li><p><code>logjac</code> is the the log Jacobian determinant or a placeholder, depending on <code>flag</code>,</p></li><li><p><code>index′</code> is the next index in <code>x</code> after the elements used for the transformation</p></li></ul><p><strong>Internal function</strong>. Implementations</p><ol><li>can assume that <code>x</code> has enough elements for <code>transformation</code> (ie <code>@inbounds</code> can be</li></ol><p>used),</p><ol><li>should work with generalized indexing on <code>x</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/generic.jl#L55-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables._transform_tuple" href="#TransformVariables._transform_tuple"><code>TransformVariables._transform_tuple</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">_transform_tuple(flag, x, index, ?)
</code></pre><p>Helper function for transforming tuples. Used internally, to help type inference. Use via <code>transfom_tuple</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/aggregation.jl#L150">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables._inverse!_tuple" href="#TransformVariables._inverse!_tuple"><code>TransformVariables._inverse!_tuple</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">_inverse!_tuple(x, index, ts, ys)
</code></pre><p>Helper function for inverting tuples of transformations. Used internally.</p><p><em>Performs no argument validation, caller should do this.</em></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/aggregation.jl#L186">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables._inverse_eltype_tuple" href="#TransformVariables._inverse_eltype_tuple"><code>TransformVariables._inverse_eltype_tuple</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">_inverse_eltype_tuple(ts, ys)
</code></pre><p>Helper function determining element type of inverses from tuples. Used internally.</p><p><em>Performs no argument validation, caller should do this.</em></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/aggregation.jl#L175">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.unit_triangular_dimension" href="#TransformVariables.unit_triangular_dimension"><code>TransformVariables.unit_triangular_dimension</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">unit_triangular_dimension(n)
</code></pre><p>Number of elements (strictly) above the diagonal in an <span>$n×n$</span> matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/utilities.jl#L20-L24">source</a></section></article><h2 id="Building-blocks-for-transformations-1"><a class="docs-heading-anchor" href="#Building-blocks-for-transformations-1">Building blocks for transformations</a><a class="docs-heading-anchor-permalink" href="#Building-blocks-for-transformations-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.l2_remainder_transform" href="#TransformVariables.l2_remainder_transform"><code>TransformVariables.l2_remainder_transform</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">(y, r, ℓ) =</code></pre><pre><code class="language-julia">l2_remainder_transform(flag, x, r)
</code></pre><p>Given <span>$x ∈ ℝ$</span> and <span>$0 ≤ r ≤ 1$</span>, return <code>(y, r′)</code> such that</p><ol><li><p><span>$y² + r′² = r²$</span>,</p></li><li><p><span>$y: |y| ≤ r$</span> is mapped with a bijection from <code>x</code>.</p></li></ol><p><code>ℓ</code> is the log Jacobian (whether it is evaluated depends on <code>flag</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/special_arrays.jl#L7-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransformVariables.l2_remainder_inverse" href="#TransformVariables.l2_remainder_inverse"><code>TransformVariables.l2_remainder_inverse</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">(x, r′) =</code></pre><pre><code class="language-julia">l2_remainder_inverse(y, r)
</code></pre><p>Inverse of <a href="#TransformVariables.l2_remainder_transform"><code>l2_remainder_transform</code></a> in <code>x</code> and <code>y</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/9750cb06bfc21a945e9a88951514339909369e5d/src/special_arrays.jl#L24-L28">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 20 December 2019 14:54">Friday 20 December 2019</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
